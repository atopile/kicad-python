##########################################################################
# Build KiCad-Python on Fedora
##########################################################################
build-job:
  stage: build
  image: registry.gitlab.com/kicad/kicad-ci/source_containers/master/fedora:38
  before_script:
    - git submodule update --init
    - dnf install protobuf-compiler
    - pip3 install poetry pre-commit virtualenv
    - pre-commit install
    # - poetry shell # can not be used in CI https://github.com/orgs/python-poetry/discussions/3526
    - python3 -m venv env
    - source env/bin/activate
    - poetry install
  script:
    - poetry build
    #- python3 examples/layer_indicator/layer_indicator.py # kicad needs to be builded and started before executing this
